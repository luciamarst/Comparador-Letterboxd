<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recomendador Letterboxd</title>
    <link rel="stylesheet" href="\static\style.css">
</head>



<body>
    <!-- Fondo con grid de im√°genes -->
    <div class="background-grid">
        <div class="bg-banner"></div>
        <div class="bg-left"></div>
        <div class="bg-center"></div>
        <div class="bg-right"></div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-content">
            <div class="spinner-container">
                <div class="spinner"></div>
                <div class="spinner-images">
                    <div class="spinner-image active" id="image1"></div>
                    <div class="spinner-image" id="image2"></div>
                    <div class="spinner-image" id="image3"></div>
                </div>
            </div>
            <h3>Analizando compatibilidad...</h3>
            <p>Por favor, espera mientras procesamos tus datos</p>
            <div class="loading-steps">
                <div class="step active" id="step1">üìÅ Cargando archivos...</div>
                <div class="step" id="step2">üé¨ Analizando pel√≠culas...</div>
                <div class="step" id="step3">üé≠ Procesando g√©neros...</div>
                <div class="step" id="step4">üìä Calculando compatibilidad...</div>
            </div>
            <p>Esto puede tardar unos minutos debido a la cantidad de datos a procesar.</p>
        </div>
    </div>

    <div class="container">
        <header>
            <h1>Compatibilidad <br> Cinematografica</h1>
            <p>Descubre qu√© tan compatible eres con otra persona bas√°ndose en vuestras cuentas de Letterboxd</p>
        </header>

        <form action="/analizar" method="post" enctype="multipart/form-data" class="upload-form" id="analyzForm">
            <div class="personas-container">
                <div class="persona">
                    <h2>Persona 1</h2>
                    <div class="file-group">
                        <label for="watchlist1">Watchlist CSV:</label>
                        <input type="file" id="watchlist1" name="watchlist1" accept=".csv" required>
                    </div>
                    <div class="file-group">
                        <label for="ratings1">Ratings CSV:</label>
                        <input type="file" id="ratings1" name="ratings1" accept=".csv" required>
                    </div>
                    <div class="file-group">
                        <label for="watched1">Watched CSV:</label>
                        <input type="file" id="watched1" name="watched1" accept=".csv" required>
                    </div>
                </div>

                <div class="persona">
                    <h2>Persona 2</h2>
                    <div class="file-group">
                        <label for="watchlist2">Watchlist CSV:</label>
                        <input type="file" id="watchlist2" name="watchlist2" accept=".csv" required>
                    </div>
                    <div class="file-group">
                        <label for="ratings2">Ratings CSV:</label>
                        <input type="file" id="ratings2" name="ratings2" accept=".csv" required>
                    </div>
                    <div class="file-group">
                        <label for="watched2">Watched CSV:</label>
                        <input type="file" id="watched2" name="watched2" accept=".csv" required>
                    </div>
                </div>
            </div>

            <!-- BOT√ìN CON ID PARA EL JAVASCRIPT -->
            <button type="submit" class="analyze-btn" id="submitBtn">
                <div class="analyze-btn-left"></div>
                <div class="analyze-btn-center"><span> Analizar Compatiblidad</span></div>
                <div class="analyze-btn-right"></div>
                <span id="btnLoading" style="display: none;">‚è≥ Analizando...</span>
            </button>
        </form>

        <div class="info">
            <h3>¬øC√≥mo obtener tus archivos CSV?</h3>
            <p>1. Ve a <a href="https://letterboxd.com/settings/data" target="_blank">letterboxd.com/settings/data</a></p>
            <p>2. Solicita la exportaci√≥n de datos</p>
            <p>3. Descarga los archivos CSV necesarios</p>
        </div>

        <div class="info">
            <h3>¬øPor qu√© son necesarios los archivos.csv de ambas personas?</h3>
            <p>Los archivos CSV de ambas personas son necesarios para poder comparar sus listas de pel√≠culas vistas, calificaciones y watchlists. Debido a que letterboxd no permite acceder a esta informaci√≥n de forma directa a trav√©s de su API, es necesario utilizar los archivos exportados por los usuarios.</p>
            <div class="aviso">De lo contrario podr√≠a violar los t√©rminos y condiciones de Letterboxd.</div>
        </div>

    </div>


    <script>
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('analyzForm').addEventListener('submit', function(e) {
                // Mostrar loading
                document.getElementById('loadingOverlay').style.display = 'flex';
                
                // Cambiar bot√≥n
                const btnLoading = document.getElementById('btnLoading');
                const submitBtn = document.getElementById('submitBtn');
                
                if (btnLoading) btnLoading.style.display = 'inline';
                if (submitBtn) submitBtn.disabled = true;
                
                // Iniciar animaci√≥n de im√°genes
                startImageCycle();
                
                // Simular progreso de pasos
                setTimeout(() => {
                    updateStep('step1', 'step2');
                }, 2000);
                
                setTimeout(() => {
                    updateStep('step2', 'step3');
                }, 4000);
                
                setTimeout(() => {
                    updateStep('step3', 'step4');
                }, 6000);
            });
            
            function updateStep(currentId, nextId) {
                const current = document.getElementById(currentId);
                const next = document.getElementById(nextId);
                
                if (current) {
                    current.classList.add('completed');
                    current.classList.remove('active');
                }
                if (next) {
                    next.classList.add('active');
                }
            }
            
            function startImageCycle() {
                const images = document.querySelectorAll('.spinner-image');
                let currentIndex = 0;
                
                // Funci√≥n para cambiar im√°genes manualmente (alternativa a CSS)
                function cycleImages() {
                    images.forEach((img, index) => {
                        img.classList.remove('active');
                        if (index === currentIndex) {
                            img.classList.add('active');
                        }
                    });
                    
                    currentIndex = (currentIndex + 1) % images.length;
                }
                
                // Cambiar imagen cada 2 segundos
                setInterval(cycleImages, 2000);
            }
        });
        </script>
</body>
</html>